var galleryApp=angular.module("galleryApp",["ngRoute"]).config(["$routeProvider","$locationProvider",function(a){a.when("/",{controller:"homeController",templateUrl:"app/views/home.html"}).when("/author/:name",{controller:"authorController",templateUrl:"app/views/home.html"}).when("/extension/:id/",{controller:"extensionController",templateUrl:"app/views/extension.html"}).when("/upload",{controller:"uploadController",templateUrl:"app/views/upload.html"}).otherwise({redirectTo:"/"})}]),constants={DEFAULT_ICON_IMAGE:"/img/default-icon.png",DEFAULT_PREVIEW_IMAGE:"/img/default-preview.png"};galleryApp.service("dataService",["$http",function(a){var b="/extension/";this.normalizePackage=function(a){return a.DownloadUrl="/extensions/"+a.ID+"/extension.vsix",a.Icon=a.Icon?"/extensions/"+a.ID+"/preview.png":constants.DEFAULT_ICON_IMAGE,a.Preview=a.Preview?"/extensions/"+a.ID+"/preview.png":constants.DEFAULT_PREVIEW_IMAGE,a.SupportedVersions=a.SupportedVersions.map(function(a){return 0==a.indexOf("11.")?2012:0==a.indexOf("12.")?2013:0==a.indexOf("14.")?2015:void 0}),a},this.getAllExtensions=function(){return a.get(b)},this.getExtension=function(c){return a.get(b+"get/"+c)},this.upload=function(c){return a.post(b+"uploadfile",new Blob([c],{}))}}]),galleryApp.controller("homeController",["$scope","dataService",function(a,b){a.headline="Nightly builds of popular extensions",a.feed="/feed/",a.query="",a.packageSearch=function(b){var c=a.query.toUpperCase();return-1!=b.Name.toUpperCase().indexOf(c)||-1!=b.Description.toUpperCase().indexOf(c)||-1!=b.Author.toUpperCase().indexOf(c)||-1!=b.Tags.toUpperCase().indexOf(c)},b.getAllExtensions().success(function(c){for(var d=0;d<c.length;d++)b.normalizePackage(c[d]);a.packages=c})}]),galleryApp.controller("extensionController",["$scope","$location","$route","dataService",function(a,b,c,d){var e=c.current.params.id;a.older=[],d.getExtension(e).success(function(c){c.Error&&b.path("/");d.normalizePackage(c);a["package"]=c})}]),galleryApp.controller("uploadController",["$scope","$location","dataService",function(a,b,c){a.error="",a.upload=function(){var d=document.getElementById("uploadfile"),e=new FileReader;e.onload=function(d){c.upload(d.target.result).success(function(a){b.path("/extension/"+a.ID)}).error(function(b,c){switch(c){case 500:a.error="A problem occured reading your VSIX. Please make sure your VSIX is valid";break;default:a.error="Unknown error occured. Please make sure your VSIX is valid."}})},e.readAsArrayBuffer(d.files[0])}}]),angular.module("galleryApp").run(["$templateCache",function(a){"use strict";a.put("app/views/extension.html",'<div id=extensions><div ng-model=package ng-show=package><h1 class=page-header>{{package.Name}}</h1><article><img class=preview ng-src={{package.Preview}} alt="{{package.Name}}"><p>{{package.Description}}</p><div class=details><p><strong>Author:</strong> <a ng-href="#/author/{{package.Author | lowercase }}">{{package.Author}}</a></p><p><strong>Supports:</strong> Visual Studio <span ng-repeat="version in package.SupportedVersions">{{version + \'&nbsp;\'}}</span></p><p><strong>Tags:</strong> {{package.Tags}}</p><p><strong>Version:</strong> {{package.Version}}</p><p><strong>Updated:</strong> <time>{{package.DatePublished | date:\'MMM d. yyyy\'}}</time></p></div><br><a class="btn-sm btn-primary" ng-href={{package.DownloadUrl}}><span class="glyphicon glyphicon-cloud-download" aria-hidden=true></span> Download</a> <a class="btn-sm btn-success" ng-href=/feed/extension/{{package.ID}}><span class="glyphicon glyphicon-cog" aria-hidden=true></span> Feed</a></article><br><div ng-show=package.License><h2>License</h2><pre>{{package.License}}</pre></div></div></div>'),a.put("app/views/home.html",'<h1 class=page-header>{{headline}} <a ng-href={{feed}} class="btn btn-success"><span class="glyphicon glyphicon-cog" aria-hidden=true></span> Feed</a></h1><div id=extensions><div id=searchform class=form-group><label class=sr-only for=search>Search</label><div class=input-group><div class=input-group-addon><span class="glyphicon glyphicon-search"></span></div><input type=text id=search ng-model=query placeholder=Search class="form-control"></div></div><article ng-repeat="package in packages | filter: packageSearch"><img class=icon ng-src={{package.Icon}} alt="{{package.Name}}"><h3><a ng-href=#/extension/{{package.ID}}>{{package.Name}}</a></h3><a ng-href="#/author/{{package.Author | lowercase }}">{{package.Author}}</a><p>{{package.Description}}</p><a class="btn-sm btn-primary" ng-href={{package.DownloadUrl}}><span class="glyphicon glyphicon-cloud-download" aria-hidden=true></span> Download</a> <a ng-href=/feed/extension/{{package.ID}} class="btn-sm btn-success"><span class="glyphicon glyphicon-cog" aria-hidden=true></span> Feed</a> <time>{{package.DatePublished | date:\'&nbsp;MMM d. yyyy\'}}</time></article></div>'),a.put("app/views/upload.html",'<h1 class=page-header>Upload new extension</h1><p>Tincidunt integer eu augue augue nunc elit dolor, luctus placerat scelerisque euismod, iaculis eu lacus nunc mi elit, vehicula ut laoreet ac, aliquam sit amet justo nunc tempor, metus vel.</p><form id=upload ng-hide=form.$submitted><input type=file id=uploadfile placeholder="URI to VSIX file" required> <a class="btn-sm btn-primary" ng-click=upload()><span class="glyphicon glyphicon-cloud-upload" aria-hidden=true></span> Upload</a><p class=has-error ng-show="upload.url.$invalid || error">{{error}}</p></form>')}]),galleryApp.controller("authorController",["$scope","$route","dataService",function(a,b,c){function d(a){return a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}a.headline="Extensions by "+d(b.current.params.name),a.feed="/feed/author/"+b.current.params.name+"/",a.query="",a.packageSearch=function(b){var c=a.query.toUpperCase();return-1!=b.Name.toUpperCase().indexOf(c)||-1!=b.Description.toUpperCase().indexOf(c)||-1!=b.Author.toUpperCase().indexOf(c)||-1!=b.Tags.toUpperCase().indexOf(c)},c.getAllExtensions().success(function(d){packages=[];for(var e=0;e<d.length;e++){var f=d[e];f.Author.toUpperCase()===b.current.params.name.toUpperCase()&&packages.push(c.normalizePackage(f))}a.packages=packages})}]);